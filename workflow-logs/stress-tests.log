=== STRESS TESTS WORKFLOW STARTED ===
Stress Tests Configuration:
  SIMULATOR_NUM_MESSAGES: 1000000
  MAX_ALLOWED_TIME_MS: 10000
Installing .NET Aspire Workload...

Skipping NuGet package signature verification.
Installing workload manifest microsoft.net.workload.mono.toolchain.current version 8.0.17...
Installing workload manifest microsoft.net.workload.emscripten.current version 8.0.17...
Installing workload manifest microsoft.net.workload.emscripten.net6 version 8.0.17...
Installing workload manifest microsoft.net.workload.emscripten.net7 version 8.0.17...
Installing workload manifest microsoft.net.workload.mono.toolchain.net6 version 8.0.17...
Installing workload manifest microsoft.net.workload.mono.toolchain.net7 version 8.0.17...
Installing workload manifest microsoft.net.sdk.aspire version 8.2.2...
Installing pack Aspire.Hosting.Sdk version 8.0.0-preview.1.23557.2...
Writing workload pack installation record for Aspire.Hosting.Sdk version 8.0.0-preview.1.23557.2...
Installing pack Aspire.ProjectTemplates version 8.0.0-preview.1.23557.2...
Pack Aspire.ProjectTemplates version 8.0.0-preview.1.23557.2 is already installed.
Writing workload pack installation record for Aspire.ProjectTemplates version 8.0.0-preview.1.23557.2...
Installing pack Aspire.Hosting.Orchestration.linux-x64 version 8.0.0-preview.1.23557.2...
Writing workload pack installation record for Aspire.Hosting.Orchestration version 8.0.0-preview.1.23557.2...
Installing pack Aspire.Hosting version 8.0.0-preview.1.23557.2...
Writing workload pack installation record for Aspire.Hosting version 8.0.0-preview.1.23557.2...
Garbage collecting for SDK feature band(s) 8.0.100...
Uninstalling workload pack Aspire.Hosting version 8.0.0-preview.1.23557.2...
Uninstalling workload pack Aspire.Hosting.Orchestration version 8.0.0-preview.1.23557.2...

Successfully installed workload(s) aspire.

Installing workloads: 

Skipping NuGet package signature verification.
Skipping NuGet package signature verification.
Installing pack Aspire.Hosting.Sdk version 8.2.2...
Pack Aspire.Hosting.Sdk version 8.2.2 is already installed.
Writing workload pack installation record for Aspire.Hosting.Sdk version 8.2.2...
Installing pack Aspire.ProjectTemplates version 8.2.2...
Pack Aspire.ProjectTemplates version 8.2.2 is already installed.
Writing workload pack installation record for Aspire.ProjectTemplates version 8.2.2...
Garbage collecting for SDK feature band(s) 8.0.100...

Successfully installed workload(s) aspire.

Installing workloads: 

Skipping NuGet package signature verification.
Installing pack Aspire.Hosting.Sdk version 8.2.2...
Pack Aspire.Hosting.Sdk version 8.2.2 is already installed.
Writing workload pack installation record for Aspire.Hosting.Sdk version 8.2.2...
Installing pack Aspire.ProjectTemplates version 8.2.2...
Pack Aspire.ProjectTemplates version 8.2.2 is already installed.
Writing workload pack installation record for Aspire.ProjectTemplates version 8.2.2...
Garbage collecting for SDK feature band(s) 8.0.100...

Successfully installed workload(s) aspire.

Installing workloads: 

Skipping NuGet package signature verification.
Skipping NuGet package signature verification.
Installing pack Aspire.Hosting.Sdk version 8.2.2...
Pack Aspire.Hosting.Sdk version 8.2.2 is already installed.
Writing workload pack installation record for Aspire.Hosting.Sdk version 8.2.2...
Installing pack Aspire.ProjectTemplates version 8.2.2...
Pack Aspire.ProjectTemplates version 8.2.2 is already installed.
Writing workload pack installation record for Aspire.ProjectTemplates version 8.2.2...
Garbage collecting for SDK feature band(s) 8.0.100...

Successfully installed workload(s) aspire.

Building FlinkDotNet solution...
MSBuild version 17.8.27+3ab07f0cf for .NET
  Determining projects to restore...
  All projects are up-to-date for restore.
  FlinkDotNet.Common.Constants -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Common.Constants/bin/Release/net8.0/FlinkDotNet.Common.Constants.dll
  FlinkDotNet.Core.Abstractions -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Core.Abstractions/bin/Release/net8.0/FlinkDotNet.Core.Abstractions.dll
  FlinkDotNet.Storage.RocksDB -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Storage.RocksDB/bin/Debug/net8.0/FlinkDotNet.Storage.RocksDB.dll
  FlinkDotNet.Common.Constants.Tests -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Common.Constants.Tests/bin/Release/net8.0/FlinkDotNet.Common.Constants.Tests.dll
  FlinkDotNet.Core -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Core/bin/Release/net8.0/FlinkDotNet.Core.dll
  FlinkDotNet.Connectors.Sources.Kafka -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Connectors.Sources.Kafka/bin/Release/net8.0/FlinkDotNet.Connectors.Sources.Kafka.dll
  FlinkDotNet.Storage.FileSystem -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Storage.FileSystem/bin/Release/net8.0/FlinkDotNet.Storage.FileSystem.dll
  FlinkDotNet.Connectors.Sinks.Console -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Connectors.Sinks.Console/bin/Release/net8.0/FlinkDotNet.Connectors.Sinks.Console.dll
  FlinkDotNet.Connectors.Sources.File -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Connectors.Sources.File/bin/Release/net8.0/FlinkDotNet.Connectors.Sources.File.dll
  FlinkDotNet.Connectors.Sinks.Console.Tests -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Connectors.Sinks.Console.Tests/bin/Release/net8.0/FlinkDotNet.Connectors.Sinks.Console.Tests.dll
  FlinkDotNet.Storage.FileSystem.Tests -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Storage.FileSystem.Tests/bin/Release/net8.0/FlinkDotNet.Storage.FileSystem.Tests.dll
  FlinkDotNet.Core.Tests -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Core.Tests/bin/Release/net8.0/FlinkDotNet.Core.Tests.dll
  FlinkDotNet.Connectors.Sources.File.Tests -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Connectors.Sources.File.Tests/bin/Release/net8.0/FlinkDotNet.Connectors.Sources.File.Tests.dll
  FlinkDotNet.JobManager -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.JobManager/bin/Release/net8.0/FlinkDotNet.JobManager.dll
  FlinkDotNet.Core.Api -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Core.Api/bin/Release/net8.0/FlinkDotNet.Core.Api.dll
  FlinkDotNet.Table.Api -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Table.Api/bin/Release/net8.0/FlinkDotNet.Table.Api.dll
  FlinkDotNet.TaskManager -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.TaskManager/bin/Release/net8.0/FlinkDotNet.TaskManager.dll
  FlinkDotNet.JobManager.Tests -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.JobManager.Tests/bin/Release/net8.0/FlinkDotNet.JobManager.Tests.dll
  FlinkDotNet.Architecture.Tests -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Architecture.Tests/bin/Release/net8.0/FlinkDotNet.Architecture.Tests.dll

Build succeeded.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:01:12.21
Building FlinkDotNetAspire solution...
MSBuild version 17.8.27+3ab07f0cf for .NET
  Determining projects to restore...
  Restored /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/IntegrationTestVerifier/IntegrationTestVerifier.csproj (in 3.55 sec).
  Restored /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.AppHost.ServiceDefaults/FlinkDotNetAspire.AppHost.ServiceDefaults.csproj (in 3.75 sec).
  Restored /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/FlinkDotNetAspire.IntegrationTests.csproj (in 3.94 sec).
  12 of 15 projects are up-to-date for restore.
  FlinkDotNet.Common.Constants -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Common.Constants/bin/Debug/net8.0/FlinkDotNet.Common.Constants.dll
  FlinkDotNetAspire.AppHost.ServiceDefaults -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.AppHost.ServiceDefaults/bin/Release/net8.0/FlinkDotNetAspire.AppHost.ServiceDefaults.dll
  IntegrationTestVerifier -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/IntegrationTestVerifier/bin/Release/net8.0/FlinkDotNet.IntegrationTestVerifier.dll
  FlinkDotNet.Core.Abstractions -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Core.Abstractions/bin/Debug/net8.0/FlinkDotNet.Core.Abstractions.dll
  FlinkDotNet.Storage.RocksDB -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Storage.RocksDB/bin/Debug/net8.0/FlinkDotNet.Storage.RocksDB.dll
  FlinkDotNet.JobManager -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.JobManager/bin/Release/net8.0/FlinkDotNet.JobManager.dll
  FlinkDotNet.Core.Api -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Core.Api/bin/Debug/net8.0/FlinkDotNet.Core.Api.dll
  FlinkDotNet.Connectors.Sources.File -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Connectors.Sources.File/bin/Debug/net8.0/FlinkDotNet.Connectors.Sources.File.dll
  FlinkDotNet.Core -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Core/bin/Debug/net8.0/FlinkDotNet.Core.dll
  FlinkDotNet.Storage.FileSystem -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Storage.FileSystem/bin/Debug/net8.0/FlinkDotNet.Storage.FileSystem.dll
  FlinkDotNet.Connectors.Sinks.Console -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.Connectors.Sinks.Console/bin/Debug/net8.0/FlinkDotNet.Connectors.Sinks.Console.dll
  FlinkJobSimulator -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkJobSimulator/bin/Release/net8.0/FlinkJobSimulator.dll
  FlinkDotNet.TaskManager -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNet/FlinkDotNet.TaskManager/bin/Release/net8.0/FlinkDotNet.TaskManager.dll
  FlinkDotNetAspire.AppHost.AppHost -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.AppHost.AppHost/bin/Release/net8.0/FlinkDotNetAspire.AppHost.AppHost.dll
/usr/lib/dotnet/sdk/8.0.116/Microsoft.Common.CurrentVersion.targets(4911,5): warning MSB3026: Could not copy "/home/runner/.nuget/packages/streamjsonrpc/2.21.69/lib/net8.0/es/StreamJsonRpc.resources.dll" to "bin/Release/net8.0/es/StreamJsonRpc.resources.dll". Beginning retry 1 in 1000ms. The process cannot access the file '/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/bin/Release/net8.0/es/StreamJsonRpc.resources.dll' because it is being used by another process.  [/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/FlinkDotNetAspire.IntegrationTests.csproj]
/usr/lib/dotnet/sdk/8.0.116/Microsoft.Common.CurrentVersion.targets(4911,5): warning MSB3026: Could not copy "/home/runner/.nuget/packages/streamjsonrpc/2.21.69/lib/net8.0/ja/StreamJsonRpc.resources.dll" to "bin/Release/net8.0/ja/StreamJsonRpc.resources.dll". Beginning retry 1 in 1000ms. The process cannot access the file '/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/bin/Release/net8.0/ja/StreamJsonRpc.resources.dll' because it is being used by another process.  [/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/FlinkDotNetAspire.IntegrationTests.csproj]
/usr/lib/dotnet/sdk/8.0.116/Microsoft.Common.CurrentVersion.targets(4911,5): warning MSB3026: Could not copy "/home/runner/.nuget/packages/streamjsonrpc/2.21.69/lib/net8.0/pt-BR/StreamJsonRpc.resources.dll" to "bin/Release/net8.0/pt-BR/StreamJsonRpc.resources.dll". Beginning retry 1 in 1000ms. The process cannot access the file '/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/bin/Release/net8.0/pt-BR/StreamJsonRpc.resources.dll' because it is being used by another process.  [/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/FlinkDotNetAspire.IntegrationTests.csproj]
/usr/lib/dotnet/sdk/8.0.116/Microsoft.Common.CurrentVersion.targets(4911,5): warning MSB3026: Could not copy "/home/runner/.nuget/packages/microsoft.testplatform.objectmodel/17.14.1/lib/net8.0/ko/Microsoft.VisualStudio.TestPlatform.ObjectModel.resources.dll" to "bin/Release/net8.0/ko/Microsoft.VisualStudio.TestPlatform.ObjectModel.resources.dll". Beginning retry 1 in 1000ms. The process cannot access the file '/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/bin/Release/net8.0/ko/Microsoft.VisualStudio.TestPlatform.ObjectModel.resources.dll' because it is being used by another process.  [/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/FlinkDotNetAspire.IntegrationTests.csproj]
  FlinkDotNetAspire.IntegrationTests -> /home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/bin/Release/net8.0/FlinkDotNetAspire.IntegrationTests.dll

Build succeeded.

/usr/lib/dotnet/sdk/8.0.116/Microsoft.Common.CurrentVersion.targets(4911,5): warning MSB3026: Could not copy "/home/runner/.nuget/packages/streamjsonrpc/2.21.69/lib/net8.0/es/StreamJsonRpc.resources.dll" to "bin/Release/net8.0/es/StreamJsonRpc.resources.dll". Beginning retry 1 in 1000ms. The process cannot access the file '/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/bin/Release/net8.0/es/StreamJsonRpc.resources.dll' because it is being used by another process.  [/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/FlinkDotNetAspire.IntegrationTests.csproj]
/usr/lib/dotnet/sdk/8.0.116/Microsoft.Common.CurrentVersion.targets(4911,5): warning MSB3026: Could not copy "/home/runner/.nuget/packages/streamjsonrpc/2.21.69/lib/net8.0/ja/StreamJsonRpc.resources.dll" to "bin/Release/net8.0/ja/StreamJsonRpc.resources.dll". Beginning retry 1 in 1000ms. The process cannot access the file '/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/bin/Release/net8.0/ja/StreamJsonRpc.resources.dll' because it is being used by another process.  [/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/FlinkDotNetAspire.IntegrationTests.csproj]
/usr/lib/dotnet/sdk/8.0.116/Microsoft.Common.CurrentVersion.targets(4911,5): warning MSB3026: Could not copy "/home/runner/.nuget/packages/streamjsonrpc/2.21.69/lib/net8.0/pt-BR/StreamJsonRpc.resources.dll" to "bin/Release/net8.0/pt-BR/StreamJsonRpc.resources.dll". Beginning retry 1 in 1000ms. The process cannot access the file '/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/bin/Release/net8.0/pt-BR/StreamJsonRpc.resources.dll' because it is being used by another process.  [/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/FlinkDotNetAspire.IntegrationTests.csproj]
/usr/lib/dotnet/sdk/8.0.116/Microsoft.Common.CurrentVersion.targets(4911,5): warning MSB3026: Could not copy "/home/runner/.nuget/packages/microsoft.testplatform.objectmodel/17.14.1/lib/net8.0/ko/Microsoft.VisualStudio.TestPlatform.ObjectModel.resources.dll" to "bin/Release/net8.0/ko/Microsoft.VisualStudio.TestPlatform.ObjectModel.resources.dll". Beginning retry 1 in 1000ms. The process cannot access the file '/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/bin/Release/net8.0/ko/Microsoft.VisualStudio.TestPlatform.ObjectModel.resources.dll' because it is being used by another process.  [/home/runner/work/FLINK.NET/FLINK.NET/FlinkDotNetAspire/FlinkDotNetAspire.IntegrationTests/FlinkDotNetAspire.IntegrationTests.csproj]
    4 Warning(s)
    0 Error(s)

Time Elapsed 00:01:14.38
Starting Aspire AppHost...
Started AppHost with PID: 3833
Waiting 60 seconds for Redis/Kafka container initialization...
Discovering actual Aspire container ports...
=== Discovering Aspire Container Ports ===
Current Docker containers:
NAMES            IMAGE                                PORTS
kafka-yquycczr   confluentinc/confluent-local:7.9.0   8082/tcp, 127.0.0.1:32769->9092/tcp, 127.0.0.1:32770->9093/tcp
redis-wsphphhb   redis:7.4                            127.0.0.1:32768->6379/tcp
Using Redis container: 9b637b7b262f
Redis mapped to host port: 32768
Redis password found in container environment
Using Kafka container: 8116df38b5ea
Kafka mapped to host port: 32769

=== Discovery Results ===
âœ… Redis discovered on port: 32768
âœ… Redis password discovered
âœ… Kafka discovered on port: 32769

Environment variables set:
  DOTNET_REDIS_URL: localhost:32768,password=88CmcXUeGUth1yHANsXxxc
  DOTNET_KAFKA_BOOTSTRAP_SERVERS: localhost:32769
Port discovery completed successfully!
0
Starting health checks...
Health check attempt 1/5
=== FlinkDotNet Integration Test Verifier Started ===
Started at: 2025-06-13 12:01:33 UTC
Arguments: --health-check

=== Environment Variables ===
DOTNET_REDIS_URL: localhost:32768,password=88CmcXUeGUth1yHANsXxxc
DOTNET_KAFKA_BOOTSTRAP_SERVERS: localhost:32769
SIMULATOR_NUM_MESSAGES: 1000000
SIMULATOR_REDIS_KEY_GLOBAL_SEQUENCE: <not set>
SIMULATOR_REDIS_KEY_SINK_COUNTER: <not set>
SIMULATOR_KAFKA_TOPIC: <not set>
MAX_ALLOWED_TIME_MS: 10000
DOTNET_ENVIRONMENT: <not set>

=== Running in --health-check mode ===

ğŸ¥ === INFRASTRUCTURE HEALTH CHECK ===
ğŸ“‹ Validating Redis and Kafka container accessibility

ğŸ” DISCOVERY: Resolving service connection strings
   âœ… Redis connection string found: localhost:32768,password=88CmcXUeGUth1yHANsXxxc
   âœ… Kafka bootstrap servers found: localhost:32769
   ğŸ”Œ Testing Kafka port reachability (localhost:32769)...
      âœ… Port reachable

ğŸ”´ HEALTH CHECK 1: Redis Service
   ğŸ“Œ GIVEN: Redis container should be accessible at localhost:32768,password=88CmcXUeGUth1yHANsXxxc
   ğŸ¯ WHEN: Attempting connection and basic operations
WaitForRedisAsync: connectionString='localhost:32768,password=88CmcXUeGUth1yHANsXxxc', maxAttempts=2, delaySeconds=5
Redis attempt 1/2: Connecting to localhost:32768,password=88CmcXUeGUth1yHANsXxxc
âœ… Redis connection successful in 207ms
âœ… Redis ping successful
   âœ… THEN: Redis health check PASSED (took 235ms)

ğŸŸ¡ HEALTH CHECK 2: Kafka Service
   ğŸ“Œ GIVEN: Kafka container should be accessible at localhost:32769
   ğŸ¯ WHEN: Attempting connection and metadata retrieval
      ğŸ” Testing Kafka connectivity: bootstrapServers='localhost:32769', maxAttempts=2, delaySeconds=5
      ğŸ”§ Fixed IPv6 issue: Using 127.0.0.1:32769 instead of localhost:32769
      â³ Kafka attempt 1/2: Connecting to 127.0.0.1:32769
      âœ… Kafka connection successful in 166ms
      ğŸ“Š Found 1 topics, 1 brokers
   âœ… THEN: Kafka health check PASSED (took 300ms)

ğŸ === HEALTH CHECK SUMMARY ===
ğŸ‰ INFRASTRUCTURE: âœ… **HEALTHY** - All services accessible
   âœ“ Redis: Operational
   âœ“ Kafka: Operational
âœ… Health check PASSED on attempt 1
Running verification tests...
=== FlinkDotNet Integration Test Verifier Started ===
Started at: 2025-06-13 12:01:34 UTC
Arguments: 

=== Environment Variables ===
DOTNET_REDIS_URL: localhost:32768,password=88CmcXUeGUth1yHANsXxxc
DOTNET_KAFKA_BOOTSTRAP_SERVERS: localhost:32769
SIMULATOR_NUM_MESSAGES: 1000000
SIMULATOR_REDIS_KEY_GLOBAL_SEQUENCE: <not set>
SIMULATOR_REDIS_KEY_SINK_COUNTER: <not set>
SIMULATOR_KAFKA_TOPIC: <not set>
MAX_ALLOWED_TIME_MS: 10000
DOTNET_ENVIRONMENT: <not set>

=== Running full verification ===

=== ğŸ§ª FLINK.NET HIGH-THROUGHPUT STRESS TEST VERIFICATION ===
ğŸ“‹ BDD Test Scenario: Local High Throughput Test with Redis Sequenced Messages to Kafka & Redis Sink

ğŸ“– GIVEN: Local Flink.NET Setup with Aspire orchestration
   â”œâ”€ Redis provides sequence ID generation (key: 'flinkdotnet:global_sequence_id')
   â”œâ”€ HighVolumeSourceFunction generates 1,000,000 ordered messages
   â”œâ”€ RedisIncrementSinkFunction counts messages (key: 'flinkdotnet:sample:processed_message_counter')
   â””â”€ KafkaSinkFunction writes messages to topic ('flinkdotnet.sample.topic')

ğŸ¯ WHEN: FlinkJobSimulator executes the dual-sink job
   â”œâ”€ Source: Redis INCR generates sequence IDs 1 to N
   â”œâ”€ Map: SimpleToUpperMapOperator processes messages (P=1 for FIFO order)
   â”œâ”€ Fork: Stream splits to Redis sink AND Kafka sink
   â””â”€ Execution: LocalStreamExecutor runs the job

âœ… THEN: Expected behavior according to documentation:
   â”œâ”€ Global sequence key should equal 1,000,000
   â”œâ”€ Sink counter key should equal 1,000,000
   â”œâ”€ Kafka topic contains 1,000,000 ordered messages
   â””â”€ FIFO ordering maintained with Redis-generated sequence IDs

âœ… Redis connection discovered: localhost:32768,password=88CmcXUeGUth1yHANsXxxc
âœ… Kafka bootstrap servers discovered: localhost:32769

ğŸ” === VERIFICATION EXECUTION ===

ğŸ”´ SCENARIO 1: Redis Sink Verification
   ğŸ“‹ Testing: Source sequence generation and sink message counting
ğŸ”— Connecting to Redis (localhost:32768,password=88CmcXUeGUth1yHANsXxxc)...
   âœ… Successfully connected to Redis.

   ğŸ“‹ Verifying Redis data according to stress test documentation:

   ğŸ” TEST 1.1: Checking Source Sequence Generation
      ğŸ“Œ GIVEN: Redis key 'flinkdotnet:global_sequence_id' should exist
      ğŸ¯ WHEN: FlinkJobSimulator completed execution
         ğŸ“Š Key exists with value: 27,598
      âŒ THEN: Value validation FAILED
         ğŸ“Š Expected: 1,000,000 messages
         ğŸ“Š Actual: 27,598 messages
         ğŸ“Š Difference: 972,402 messages (97.2% gap)
         ğŸ’¡ This indicates HighVolumeSourceFunction stopped early or encountered errors

   ğŸ” TEST 1.2: Checking Redis Sink Processing
      ğŸ“Œ GIVEN: Redis key 'flinkdotnet:sample:processed_message_counter' should exist
      ğŸ¯ WHEN: FlinkJobSimulator completed execution
      âŒ THEN: Key validation FAILED - Redis key 'flinkdotnet:sample:processed_message_counter' not found
         ğŸ’¡ This indicates the redis sink processing did not execute or failed to write

   ğŸ’¥ Redis verification result: âŒ **FAILED**
      âŒ Message count mismatch indicates processing pipeline issues

ğŸŸ¡ SCENARIO 2: Kafka Sink Verification
   ğŸ“‹ Testing: Message ordering and content in Kafka topic

   ğŸ”— Connecting to Kafka (localhost:32769)...
   ğŸ”§ Fixed IPv6 issue: Using 127.0.0.1:32769 instead of localhost:32769
   ğŸ“‹ GIVEN: Kafka topic 'flinkdotnet.sample.topic' should contain ordered messages
   ğŸ¯ WHEN: FlinkJobSimulator completed execution via KafkaSinkFunction
   âœ… Successfully subscribed to Kafka topic: flinkdotnet.sample.topic
Starting to consume messages (timeout: 30s)...
âŒ Kafka consume error: Subscribed topic not available: flinkdotnet.sample.topic: Broker: Unknown topic or partition
  Error code: UnknownTopicOrPart
Kafka consumption completed in 1.0s
Total messages received: 0

      ğŸ” TEST 2.1: Message Volume Validation
         ğŸ“Œ GIVEN: Expected 1,000,000 messages in topic
         ğŸ“Š ACTUAL: Received 0 messages
         âŒ THEN: Volume validation FAILED
            ğŸ“Š Shortfall: 1,000,000 messages (100.0% missing)
            ğŸ’¡ This indicates KafkaSinkFunction failed to produce all messages

   ğŸ’¥ Kafka verification result: âŒ **FAILED**
      âŒ Message consumption or ordering validation failed

ğŸš€ SCENARIO 3: Performance Requirements
   ğŸ“‹ Testing: Processing time within acceptable limits
   ğŸ“Š Actual verification time: 1,436ms for 1,000,000 messages
   âœ… THEN: Performance requirement PASSED
      ğŸ“ˆ Expected: â‰¤ 10,000ms, Actual: 1,436ms

ğŸ === FINAL VERIFICATION RESULT ===
ğŸ’¥ STRESS TEST: âŒ **FAILED** - One or more scenarios failed validation
   â„¹ï¸  Check individual scenario results above for details
ğŸ“… Completed at: 2025-06-13 12:01:35 UTC
âŒ Stress Tests Workflow Failed: Verification tests failed
=== STRESS TESTS WORKFLOW FAILED after 3.9 minutes ===
Stopping AppHost...
